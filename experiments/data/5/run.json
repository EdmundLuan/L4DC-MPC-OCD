{
  "artifacts": [],
  "command": "merging_cioc_beta_experiment",
  "experiment": {
    "base_dir": "/Users/avikj/projects/interact-drive-chanlaw/experiments",
    "dependencies": [
      "numpy==1.18.1",
      "sacred==0.8.1",
      "tensorflow==2.1.0"
    ],
    "mainfile": "merging_cioc.py",
    "name": "CIOC-merging-beta",
    "repositories": [
      {
        "commit": "3dd449d6b3f44496d81615e306081b78ca34533d",
        "dirty": true,
        "url": "https://github.com/Chanlaw/interact-drive"
      },
      {
        "commit": "3dd449d6b3f44496d81615e306081b78ca34533d",
        "dirty": true,
        "url": "https://github.com/Chanlaw/interact-drive"
      }
    ],
    "sources": [
      [
        "merging.py",
        "_sources/merging_1ea0dbf9ed0f19e6a481f7dc4f84cc6a.py"
      ],
      [
        "merging_cioc.py",
        "_sources/merging_cioc_90ac196321874b9f5324d3f0e55b4b69.py"
      ]
    ]
  },
  "fail_trace": [
    "Traceback (most recent call last):\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/sacred-0.8.1-py3.7.egg/sacred/config/captured_function.py\", line 42, in captured_function\n    result = wrapped(*args, **kwargs)\n",
    "  File \"merging_cioc.py\", line 54, in merging_cioc_beta_experiment\n    past_state, controls, state = world.step()\n",
    "  File \"/Users/avikj/projects/interact-drive-chanlaw/interact_drive/world.py\", line 104, in step\n    car.set_next_control()\n",
    "  File \"/Users/avikj/projects/interact-drive-chanlaw/interact_drive/car/car.py\", line 120, in set_next_control\n    self.control = self._get_next_control()\n",
    "  File \"/Users/avikj/projects/interact-drive-chanlaw/interact_drive/car/planner_car.py\", line 52, in _get_next_control\n    self.plan = self.planner.generate_plan()\n",
    "  File \"/Users/avikj/projects/interact-drive-chanlaw/interact_drive/planner/naive_planner.py\", line 91, in generate_plan\n    self.optimizer.minimize(loss, self.planned_controls)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/keras/optimizer_v2/optimizer_v2.py\", line 316, in minimize\n    loss, var_list=var_list, grad_loss=grad_loss)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/keras/optimizer_v2/optimizer_v2.py\", line 350, in _compute_gradients\n    loss_value = loss()\n",
    "  File \"/Users/avikj/projects/interact-drive-chanlaw/interact_drive/planner/naive_planner.py\", line 88, in loss\n    return -self.reward_func(init_state, self.planned_controls, weights)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 568, in __call__\n    result = self._call(*args, **kwds)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 615, in _call\n    self._initialize(args, kwds, add_initializers_to=initializers)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 497, in _initialize\n    *args, **kwds))\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2389, in _get_concrete_function_internal_garbage_collected\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2703, in _maybe_define_function\n    graph_function = self._create_graph_function(args, kwargs)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2593, in _create_graph_function\n    capture_by_value=self._capture_by_value),\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py\", line 978, in func_graph_from_py_func\n    func_outputs = python_func(*func_args, **func_kwargs)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 439, in wrapped_fn\n    return weak_wrapped_fn().__wrapped__(*args, **kwds)\n",
    "  File \"/Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py\", line 968, in wrapper\n    raise e.ag_error_metadata.to_exception(e)\n",
    "ValueError: in converted code:\n\n    /Users/avikj/projects/interact-drive-chanlaw/interact_drive/planner/naive_planner.py:54 mpc_reward  *\n        r += self.car.reward_fn(world_state, control)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py:568 __call__\n        result = self._call(*args, **kwds)\n    /Users/avikj/projects/interact-drive-chanlaw/interact_drive/car/linear_reward_car.py:53 reward_fn  *\n        return tf.reduce_sum(self.weights_tf * feats, axis=-1)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/ops/variables.py:1082 _run_op\n        return tensor_oper(a.value(), *args, **kwargs)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/ops/math_ops.py:902 binary_op_wrapper\n        return func(x, y, name=name)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/ops/math_ops.py:1201 _mul_dispatch\n        return gen_math_ops.mul(x, y, name=name)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/ops/gen_math_ops.py:6125 mul\n        \"Mul\", x=x, y=y, name=name)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/framework/op_def_library.py:742 _apply_op_helper\n        attrs=attr_protos, op_def=op_def)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py:595 _create_op_internal\n        compute_device)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:3322 _create_op_internal\n        op_def=op_def)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:1786 __init__\n        control_input_ops)\n    /Users/avikj/projects/venv-interact-drive-chanlaw/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:1622 _create_c_op\n        raise ValueError(str(e))\n\n    ValueError: Dimensions must be equal, but are 6 and 5 for 'mul' (op: 'Mul') with input shapes: [6], [5].\n\n"
  ],
  "heartbeat": "2020-01-30T23:19:53.981033",
  "host": {
    "ENV": {},
    "cpu": "Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz",
    "hostname": "aviks-mbp-2.dyn.berkeley.edu",
    "os": [
      "Darwin",
      "Darwin-19.0.0-x86_64-i386-64bit"
    ],
    "python_version": "3.7.5"
  },
  "meta": {
    "command": "merging_cioc_beta_experiment",
    "options": {
      "--beat-interval": null,
      "--capture": null,
      "--comment": null,
      "--debug": false,
      "--enforce_clean": false,
      "--file_storage": "data",
      "--force": false,
      "--help": false,
      "--loglevel": null,
      "--mongo_db": null,
      "--name": null,
      "--pdb": false,
      "--print-config": false,
      "--priority": null,
      "--queue": false,
      "--s3": null,
      "--sql": null,
      "--tiny_db": null,
      "--unobserved": false,
      "COMMAND": null,
      "UPDATE": [],
      "help": false,
      "with": false
    }
  },
  "resources": [],
  "result": null,
  "start_time": "2020-01-30T23:19:52.806422",
  "status": "FAILED",
  "stop_time": "2020-01-30T23:19:53.982966"
}